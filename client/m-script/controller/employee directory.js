HRSupport.controller("EmployeeDirectoryCTRL", function (e, t, a, i, l, o) { e.UserDetails = JSON.parse(o.localStorage.getItem("UserDetails")), e.FilterType = [{ FilterID: 1, FilterType: "Name" }, { FilterID: 2, FilterType: "Employee ID" }, { FilterID: 3, FilterType: "Email ID" }, { FilterID: 5, FilterType: "HR Spoc(Emp ID)" }], e.Selected = { FilterType: void 0 }, e.RequestType = 0, e.RequestInfo = function (t) { t == e.RequestType ? e.RequestType = 0 : e.RequestType = t }, e.isEmpty = function (e) { return "string" == typeof e && !e.trim() || void 0 === e || null === e }, e.RaiseRequest = function (a) { var i = ""; if (i = 1 == a ? e.ContactReason : e.CTCReason, e.isEmpty(i) || i.length <= 10) return alert("Reason should be more than 10 char"), !1; i = "Please share contact number for " + e.EmpData[0].EmployeeID + "<br/>Reason : " + i; var l = { EmpID: e.UserDetails.EMPData[0].EmpID, RequestType: a, TicketSubject: "New request from " + e.UserDetails.EMPData[0].EmployeeID, Comments: i, FileURL: "", FileName: "" }; t.RaiseRequest(l, e.UserDetails.Toket).success(function (a) { var l = { CommunicationDetails: { LeadID: 0, Conversations: [{ From: "noreply-pbsupprt@policybazaar.com", ToReceipent: a.data[0][0].EmailID.split(","), BccEmail: ["asmit@policybazaar.com"], CCEmail: null, Body: "<html><body>Hi , <br/> A new ticket is raised by employee, request you to address it immediately. <br/>Employee Concern : " + i + "<br/>Employee Details <br/>Ticket# : " + a.data[0][0].TicketDispID + "<br/>Employee Name : " + e.UserDetails.EMPData[0].Name + "<br/>Employee ID : " + e.UserDetails.EMPData[0].EmployeeID + "</body></html>", Subject: "New request from " + e.UserDetails.EMPData[0].EmployeeID + " : Ticket#" + a.data[0][0].TicketDispID, CreatedBy: "Asmit", MailAttachments: [], UserID: 124, AutoTemplate: !0 }], CommunicationType: 1 } }; t.SendEmail(l).success(function (e) { }), alert("Request Raised"), e.RequestType = 0, e.ContactReason = "", e.CTCReason = "" }) }, e.SearchEmployee = function (a) { var i = { FilterID: void 0, EmployeeID: void 0, Key: void 0 }; if (1 == a) { if (void 0 == e.Selected.FilterType) return alert("Please select filter type"), !1; i = { FilterID: e.Selected.FilterType.FilterID, EmployeeID: e.UserDetails.EMPData[0].EmpID, Key: e.KeyValue } } l.EmpID && 2 == a && (i = { FilterID: 4, EmployeeID: e.UserDetails.EMPData[0].EmpID, Key: atob(l.EmpID) }), t.getAllEmployee(i, e.UserDetails.Toket).success(function (t) { null != t.data && (e.EmpData = t.data.length > 1 ? t.data[0] : []) }) }, e.OpenDetails = function (e) { o.location.href = "/home.html#/pbsupport/EmployeeDirectory/Details/" + btoa(e) }, e.SearchEmployee(2) });